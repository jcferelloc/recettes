<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<head>
    <title>Livre de recettes</title>
    <meta charset="utf-8">
    <link rel="icon" type="image/png" href="img/toque.png">
    <link rel="shortcut icon" type="image/x-icon" href="img/toque.ico">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=.5, shrink-to-fit=yes">
    <style>
        @font-face {
            font-family: latoLight;
            src: url(font/latolight.woff);
        }
    </style>

    <script type="text/javascript" src="lib/jquery-3.2.1.min.js"></script>
    <script>
        var page = 0;
        var nbPage = 0;
        var mode = 2;

        var gotoPage = function (page) {
            if (page == 0 || (mode == 1 && page % 2 == 0)) {

                $("#double").hide();
                $("#gauche").hide();

                $("#droite").show();
                
                loadPage(page, "droiteContent");
            }
            else if (page == nbPage-1 || mode == 1 && page % 2 == 1) {
                $("#droite").hide();
                $("#double").hide();

                $("#gauche").show();
                
                loadPage(page, "gaucheContent");
            }
            else if (mode == 2) {
                $("#droite").hide();
                $("#gauche").hide();

                $("#double").show();
                
                loadPage(page, "doubleGaucheContent");
                loadPage(page + 1, "doubleDroiteContent");
            }
        }

        var calcZoom = function (){
            var w = 210;
            var h = 149;
            if (mode == 2){
                w*=2;
            }
            var bodyWidth = ($('#backgroundBook').width() - 140) * 0.264583333333334;
            var bodyHeight = ($('#backgroundBook').height() - 20) * 0.264583333333334;
            var zoom = "" + Math.min(bodyWidth / w, bodyHeight / h) *100 + "%";
            console.log ("zoom:" + zoom );
            $("#double").css({zoom: zoom});
            $("#gauche").css({zoom: zoom});
            $("#droite").css({zoom: zoom});
        }

        var loadPage = function (number, id) {
            $("#" + id).html("");
            $.ajax({
                method: "GET",
                url: "page.php?format=html&number=" + number + "&" + Math.random(),
                success: function (data) {
                    $("#" + id).html(data);
                }
            });
        };

        $.ajax({
            method: "GET",
            url: "page.php?nbPage&" + Math.random(),
            success: function (data) {
                nbPage = parseInt(data);
            }
        });
        $("document").ready(function () {

            $(".next").click(function () {
                if ( page >= nbPage-1 ){
                    return;
                }
                if (page == 0 || mode == 1) {
                    page++;
                } else {
                    page += 2;
                }
                gotoPage(page);
            });
            $(".prev").click(function () {
                if (page > 0) {
                    if (page == 1 || mode == 1) {
                        page--;
                    } else {
                        page -= 2;
                    }
                    gotoPage(page);
                }
            });
            
            $(window).on('resize', function (){
                calcZoom();
            })
            calcZoom();
            gotoPage(0);
        });

    </script>
    <style>
        .button{
            cursor:pointer;
            color: #FFF; 
            background-color: #0095ff; 
            border: 1px solid #07c; 
            border-radius: 2px; 
            box-shadow: inset 0 1px 0 #66bfff;
            padding:10px;
            display: inline-block;
        }
        .pageBook{
            border:solid 1px #EEEEEE;
            height:100%;
            background-color:white; 
            box-shadow: 5px 5px 5px #333333; 
        }
        .prev{
            position:absolute;
            top:40%; 
            left:-30px;
            width:40px;
            height:40px;
            cursor:pointer;
        }
        .next{
            position:absolute;
            top:40%;
            right:-30px;
            width:40px;
            height:40px;
            cursor:pointer;
        }
    </style>

</head>

<body style="font-family: Arial">
    <div id="topBar" style="padding:10px; font-size: 20px;top:0px; left:0px; right:0px;  text-align:center; ">Livre de recettes - APE Le Drennec 2018</div>

    <div id="myAccount" class="button" style="position: absolute; top:10px; left:10px;"> Mes recettes </div>
    
        
    <div id="backgroundBook" style="position:absolute;padding:20px; top:50px; left:0px; right:0px; bottom:0px; ">
        
        
        <div id="double" style="display:none;position:relative;   width:423mm; height:148mm; margin:auto;">

            <div style="position:absolute;top:0px;bottom:0px; " class="pageBook">
                <div id="doubleGaucheContent"></div>
            </div>

            <div style="position:absolute;top:0px;bottom:0px; left:213mm;" class="pageBook" >
                <div id="doubleDroiteContent" ></div>
            </div>
            <img src="img/spirale-2pages.png" alt="" style="position:absolute;height:100%;left:203mm;">
            <img src="img/suivant.png" alt="suivant" class="next" >
            <img src="img/precedent.png" alt="precedent" class="prev" >
            
        </div>

        <div id="droite" style="display:none;position:relative; width:210mm; height:148mm;margin:auto;"  class="pageBook">
            <img src="img/spirale-1page.png" alt="" style="position:absolute;height:100%;left:-20px;">
            <img src="img/suivant.png" alt="suivant" class="next" >
            <div id="droiteContent" ></div>
        </div>

        <div id="gauche" style="display:none;position:relative; width:210mm; height:148mm;margin:auto; "  class="pageBook">
            <img src="img/spirale-1page-d.png" alt="" style="position:absolute;height:100%;right:-20px;">
            <img src="img/precedent.png" alt="precedent" class="prev" >
            <div id="gaucheContent" ></div>
        </div>
    </div>
</body>

</html>